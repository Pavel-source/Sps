CREATE OR REPLACE TABLE "PROD"."WORKSPACE_GREETZ_HISTORY_MIGRATION"."PRODUCT_VARIANTS"  AS (

SELECT 
PRODUCT_ID	,
MIN(VARIANT_ID)	AS VARIANT_ID,
MIN(PRODUCT_VARIANT_ID)	AS PRODUCT_VARIANT_ID,
SKU	,
SKU_VARIANT	,
PRODUCT_CREATED_AT	,
VARIANT_CREATED_AT	,
IS_PUBLISHED	,
FIRST_PUBLISHED_DATE_TIME	,
PRODUCT_TITLE	,
PRODUCT_DESCRIPTION	,
CATEGORY_NAME	,
CATEGORY_PARENT	,
HIERARCHY_RANK_1	,
HIERARCHY_RANK_2	,
HIERARCHY_RANK_3	,
HIERARCHY_RANK_4	,
HIERARCHY_RANK_5	,
UNIQUE_PRODUCT_CODE	,
PHOTO_COUNT	,
DELIVERY_TYPE	,
LETTERBOX_FRIENDLY	,
SHAPE	,
IMAGE_HEIGHT	,
IMAGE_WIDTH	,
ORIENTATION	,
-- IMAGE_URL	,
PRODUCT_BRAND	,
RANGE	,
ARENA_ID	,
PRODUCT_RANGE	,
NOTES	,
REPORTING_OCCASION	,
REPORTING_STYLE	,
REPORTING_RELATION	,
REPORTING_ARTIST	,
REPORTING_SUPPLIER	,
REPORTING_SUPPLIER_NO	,
SIZE	,
MCD_SIZE	,
MIN(CATEGORIES)	AS CATEGORIES,
SEARCH_KEYWORDS	,
PRODUCT_TYPE_NAME	,
PRODUCT_KEY	,
PRODUCT_FAMILY	,
IS_PRODUCT_VARIANT_DELETED	,
PRODUCT_VARIANT_DELETED_TIMESTAMP	,
IS_PRODUCT_DELETED	,
PRODUCT_DELETED_TIMESTAMP	,
SUPPLIER_NAME	,
LEGACY_SUPPLIER_ID	,
SUPPLIER_CITY	,
SUPPLIER_COUNTRY	,
MCD_FINANCE_CATEGORY	,
MCD_FINANCE_SUBCATEGORY	,
MESSAGE_TIMESTAMP	,
BRAND	,
RANGE_ID	,
FINANCE_PRODUCT_HIERARCHY	,
BRAND_DESCRIPTION	

FROM "PROD"."WORKSPACE_GREETZ_HISTORY_MIGRATION"."TMP_PRODUCT_VARIANTS"

GROUP BY 
PRODUCT_ID	,
 --VARIANT_ID	,
-- PRODUCT_VARIANT_ID	,
SKU	,
SKU_VARIANT	,
PRODUCT_CREATED_AT	,
VARIANT_CREATED_AT	,
IS_PUBLISHED	,
FIRST_PUBLISHED_DATE_TIME	,
PRODUCT_TITLE	,
PRODUCT_DESCRIPTION	,
CATEGORY_NAME	,
CATEGORY_PARENT	,
HIERARCHY_RANK_1	,
HIERARCHY_RANK_2	,
HIERARCHY_RANK_3	,
HIERARCHY_RANK_4	,
HIERARCHY_RANK_5	,
UNIQUE_PRODUCT_CODE	,
PHOTO_COUNT	,
DELIVERY_TYPE	,
LETTERBOX_FRIENDLY	,
SHAPE	,
IMAGE_HEIGHT	,
IMAGE_WIDTH	,
ORIENTATION	,
-- IMAGE_URL	,
PRODUCT_BRAND	,
RANGE	,
ARENA_ID	,
PRODUCT_RANGE	,
NOTES	,
REPORTING_OCCASION	,
REPORTING_STYLE	,
REPORTING_RELATION	,
REPORTING_ARTIST	,
REPORTING_SUPPLIER	,
REPORTING_SUPPLIER_NO	,
SIZE	,
MCD_SIZE	,
-- CATEGORIES	,
SEARCH_KEYWORDS	,
PRODUCT_TYPE_NAME	,
PRODUCT_KEY	,
PRODUCT_FAMILY	,
IS_PRODUCT_VARIANT_DELETED	,
PRODUCT_VARIANT_DELETED_TIMESTAMP	,
IS_PRODUCT_DELETED	,
PRODUCT_DELETED_TIMESTAMP	,
SUPPLIER_NAME	,
LEGACY_SUPPLIER_ID	,
SUPPLIER_CITY	,
SUPPLIER_COUNTRY	,
MCD_FINANCE_CATEGORY	,
MCD_FINANCE_SUBCATEGORY	,
MESSAGE_TIMESTAMP	,
BRAND	,
RANGE_ID	,
FINANCE_PRODUCT_HIERARCHY	,
BRAND_DESCRIPTION

);

